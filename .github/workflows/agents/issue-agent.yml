name: Issue Agent (Dry Run)

on:
  issues:
    types: [opened, edited, labeled]

permissions:
  contents: read
  issues: read

jobs:
  run-issue-agent:
    name: Run Product Manager Agent on Issue
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Run agent in dry-run mode
        env:
          AGENT_NAME: product-manager
          DRY_RUN: true
        run: |
          echo "Issue #${{ github.event.issue.number }}: ${{ github.event.issue.title }}"
          echo ""
          echo "Running agent analysis (dry-run mode)..."
          .github/agents/run-agent.sh
      
      - name: Output issue context
        run: |
          echo "=== Issue Context ==="
          echo "Title: ${{ github.event.issue.title }}"
          echo "Author: ${{ github.event.issue.user.login }}"
          echo "Labels: ${{ join(github.event.issue.labels.*.name, ', ') }}"
          echo ""
          echo "In a production setup, the Product Manager agent would:"
          echo "  - Analyze the issue description"
          echo "  - Generate user story and acceptance criteria"
          echo "  - Suggest priority and dependencies"
          echo "  - Post findings as a comment"
